{% extends 'base_auth.html.twig' %}

{% block title %}courseprogect.of.by | Admin Panel{% endblock %}

{% block body class="bg-light" %}
<div class="container py-5">
    <h2 class="text-primary mb-4" style="font-family: 'Orbitron', sans-serif;">Admin Panel</h2>

    <form method="post" action="{{ path('admin_action_toolbar') }}">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <div class="btn-group" role="group">
                <button type="submit" class="btn btn-outline-primary me-2 rounded" name="action" value="block">
                    <i class="bi bi-lock-fill"></i> Block
                </button>
                <button type="submit" class="btn btn-outline-primary me-2 rounded" name="action" value="unblock">
                    <i class="bi bi-unlock"></i>
                </button>
                <button type="submit" class="btn btn-outline-danger me-2 rounded" name="action" value="delete">
                    <i class="bi bi-trash-fill"></i>
                </button>
                <button type="submit" class="btn btn-outline-danger rounded" name="action" value="remove">
                    <i class="bi bi-trash"></i>
                </button>
            </div>

            <div class="position-relative">
                <button type="button" id="filterToggle" class="btn d-flex justify-content-start align-items-center" 
                        style="width:240px; background-color:white; color:black; border:1px solid #ccc;">
                    Filter
                </button>

                <div id="filterMenu" class="card p-3 shadow position-absolute end-0 mt-2"
                    style="width: 350px; display: none; z-index: 1000;">
                    <div class="mb-2">
                        <label class="form-label">Column</label>
                        <select id="filterColumn" class="form-select">
                            <option value="1">Name</option>
                            <option value="2">Email</option>
                            <option value="3">Status</option>
                            <option value="4">Last Seen</option>
                        </select>
                    </div>
                    <div class="mb-2">
                        <label class="form-label">Direction</label>
                        <select id="filterDirection" class="form-select">
                            <option value="asc">▲ Ascending</option>
                            <option value="desc">▼ Descending</option>
                        </select>
                    </div>
                    <button type="button" id="applyFilter" class="btn btn-primary w-100">Apply</button>
                    <button type="button" id="resetFilter" class="btn btn-secondary flex-fill">Reset</button>
                </div>
            </div>
        </div>

        <div class="table-responsive bg-white rounded shadow p-3">
            <table class="table table-bordered table-hover align-middle" id="userTable">
                <thead class="table-light">
                <tr>
                    <th><input type="checkbox" id="selectAll"></th>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Status</th>
                    <th>Last Seen</th>
                </tr>
                </thead>
                <tbody>
                {% for user in users %}
                    <tr>
                        <td class="{% if user.status == 'blocked' %}text-muted{% endif %}">
                            <input type="checkbox" name="selected[]" value="{{ user.id }}" class="row-checkbox">
                        </td>
                        <td class="{% if user.status == 'blocked' %}text-muted text-decoration-line-through{% endif %}">
                            {{ user.firstName }} {{ user.lastName }}
                        </td>
                        <td class="{% if user.status == 'blocked' %}text-muted{% endif %}">{{ user.email }}</td>
                        <td class="{% if user.status == 'blocked' %}text-muted{% endif %}">
                            {% if user.status == 'active' %}
                                <span>Active</span>
                            {% elseif user.status == 'blocked' %}
                                <span>Blocked</span>
                            {% elseif user.status == 'deleted' %}
                                <span>Deleted</span>
                            {% elseif user.status == 'unverified' %}
                                <span>Unverified</span>
                            {% endif %}
                        </td>
                        <td class="{% if user.status == 'blocked' %}text-muted{% endif %}">
                            {% if user.lastSeen %}
                                {{ user.lastSeen|date('d.m.Y H:i') }}
                            {% else %}
                                <span class="text-muted">Never</span>
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </form>
</div>
<script>
document.addEventListener('DOMContentLoaded', () => {
    const selectAll = document.getElementById('selectAll');
    if (selectAll) {
        selectAll.addEventListener('change', () => {
            const checked = selectAll.checked;
            document.querySelectorAll('.row-checkbox').forEach(cb => {
                cb.checked = checked;
            });
        });
    }
});
</script>
{% endblock %}
